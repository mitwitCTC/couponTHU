import{_ as u,R as p,a as m,o as e,c as i,b as r,d as t,t as o,e as n,F as g,r as b}from"./index-7f85bffb.js";const f="/couponTHU/assets/icons8-info-success-38adac5f.svg";const h="https://c7ad-122-116-23-30.ngrok-free.app",x={data(){return{isLoading:!0,billDetail:{arr_time:"",fee:"",plate:"",slipHour:"",station:""},hourArr:[],getDiscountHour:"",amount:null,today:"",getSucces:!1,hasApplied:!1,getMessage:"",stationIndex:""}},components:{RouterView:p,RouterLink:m},methods:{getPlate(){this.plate=localStorage.getItem("plate")},search(d){this.getPlate();const c=`${h}/points/search`;this.$http.post(c,{stationIndex:this.stationIndex,plate:this.plate}).then(l=>{this.isLoading=!1,l.data.arr_time&&(this.billDetail=l.data,this.checkHours())})},checkHours(){this.hourArr=this.billDetail.slipHour.split(",")},getHours(){const d=document.querySelector("#discountHours");this.getDiscountHour=d.value,this.amount=this.getDiscountHour*60,this.today="2023-09-19";const c=`${h}/points/discount`;this.$http.post(c,{amount:this.amount,IssueDate:this.today,SerialNumber:"test002"}).then(l=>{this.getMessage=l.data.message,this.getMessage=="折抵成功."?(this.hasApplied=!0,this.getSucces=!0):(this.hasApplied=!0,this.getSucces=!1),this.search()})}},mounted(){this.search()},created(){this.stationIndex=this.$route.params.stationIndex}},y=t("div",{class:"bg-dark text-white text-center py-3 mb-3"},"停車折抵查詢",-1),D={key:0,class:"loading"},v={key:1,class:"container"},k={class:"plate-bg"},H={class:"billDetail mt-2 pb-3"},A={class:"detailContent"},S={class:"amount"},I=t("p",{class:"text-secondary pt-3 ps-3"},"應繳金額",-1),w={class:"text-center"},N={class:"fs-3"},L={class:"detail"},V={class:"text-secondary"},M={class:"text-primary"},T={class:"text-secondary"},B={class:"text-primary"},C={class:"text-secondary"},R=["disabled"],q=t("option",{disabled:""},"請選擇折抵時數",-1),F=["value"],P={key:0,class:"text-secondary"},j={key:1,class:"warningInfo"},E=t("p",{class:"text-success fs-6 mt-1"},[t("img",{src:f,alt:"info-icon"}),n(" 無需繳費，請儘速離場，謝謝！")],-1),U=[E],z={class:"mt-2 d-flex justify-content-center"},G={key:2,class:"billDetail d-flex flex-column mt-5"},J={class:"text-success text-center fs-3"},K={class:"text-center"},O={class:"fs-3"},Q=t("button",{class:"btn btn-primary w-50 align-self-center mb-3"},"繳費離場",-1),W={key:3,class:"billDetail d-flex flex-column mt-5"},X={class:"text-danger text-center fs-3"},Y=t("span",{class:"text-center fs-6 mb-2"},"請直接繳費離場",-1),Z={class:"text-center"},$={class:"fs-3"},tt=t("button",{class:"btn btn-primary w-50 align-self-center mb-3"},"繳費離場",-1),st=t("p",{class:"text-danger text-center fs-6 mb-2"},"如有疑問，請洽停車場管理員",-1);function et(d,c,l,it,s,_){return e(),i("main",null,[y,s.isLoading?(e(),i("div",D)):r("",!0),!s.hasApplied&&!s.isLoading?(e(),i("div",v,[t("div",k,o(s.billDetail.plate),1),t("div",H,[t("div",A,[t("div",S,[I,t("p",w,[n("NT$ "),t("span",N,o(s.billDetail.fee),1)])]),t("div",L,[t("p",V,[n("停車地點"),t("span",M,"　"+o(s.billDetail.station),1)]),t("p",T,[n("進場時間"),t("span",B,"　"+o(s.billDetail.arr_time),1)]),t("p",C,[n("折抵時數　 "),t("select",{class:"form-select-sm",id:"discountHours",disabled:s.billDetail.amount<=0,required:""},[q,(e(!0),i(g,null,b(s.hourArr,a=>(e(),i("option",{value:a},o(a)+" 小時",9,F))),256))],8,R)])]),s.billDetail.hasApplied&&s.billDetail.amount!=0?(e(),i("div",P," 今日無法再次折抵，請直接繳費離場！ ")):r("",!0),s.billDetail.amount==0?(e(),i("div",j,U)):r("",!0),t("div",z,[t("button",{class:"btn btn-primary",onClick:c[0]||(c[0]=(...a)=>_.getHours&&_.getHours(...a))},"確認折抵")])])])])):s.hasApplied&&s.getSucces?(e(),i("div",G,[t("p",J,o(s.getMessage),1),t("p",K,[n("應繳金額 NT$ "),t("span",O,o(s.billDetail.fee),1)]),Q])):s.hasApplied&&!s.getSucces?(e(),i("div",W,[t("p",X,o(s.getMessage),1),Y,t("p",Z,[n("應繳金額 NT$ "),t("span",$,o(s.billDetail.fee),1)]),tt,st])):r("",!0)])}const nt=u(x,[["render",et]]);export{nt as default};
