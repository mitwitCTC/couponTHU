import{_ as u,R as g,a as m,o as i,c as o,b as d,d as t,t as n,e as l,F as b,r as f}from"./index-59de6bc3.js";const x="/couponTHU/assets/icons8-info-success-38adac5f.svg";const _="https://bc52-122-116-23-30.ngrok-free.app",y={data(){return{isLoading:!0,billDetail:{arr_time:"",fee:"",plate:"",slipHour:"",station:""},hourArr:[],getDiscountHour:"",amount:null,today:"",getSucces:!1,hasApplied:!1,getMessage:"",stationIndex:""}},components:{RouterView:g,RouterLink:m},methods:{getPlate(){this.plate=localStorage.getItem("plate")},search(h){this.getPlate();const e=`${_}/points/search`;this.$http.post(e,{stationIndex:this.stationIndex,plate:this.plate}).then(r=>{this.isLoading=!1,r.data.arr_time&&(this.billDetail=r.data,this.checkHours())})},checkHours(){this.hourArr=this.billDetail.slipHour.split(",")},getHours(){const h=document.querySelector("#discountHours");this.getDiscountHour=h.value,this.amount=this.getDiscountHour*60;const e=new Date;this.today=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+e.getDate();const r=`${_}/points/discount`;this.$http.post(r,{amount:this.amount,IssueDate:this.today,SerialNumber:"test006"}).then(p=>{this.getMessage=p.data.message,this.getMessage=="折抵成功."?(this.hasApplied=!0,this.getSucces=!0):(this.hasApplied=!0,this.getSucces=!1),this.search()})},pay(){parent.window.location.replace("https://utaggoif.utaggo.com.tw/payment/startpay01")}},mounted(){this.search()},created(){this.stationIndex=this.$route.params.stationIndex}},D=t("div",{class:"bg-dark text-white text-center py-3 mb-3"},"停車折抵查詢",-1),v={key:0,class:"loading"},k={key:1,class:"container"},H={class:"plate-bg"},A={class:"billDetail mt-2 pb-3"},w={class:"detailContent"},S={class:"amount"},I=t("p",{class:"text-secondary pt-3 ps-3"},"應繳金額",-1),N={class:"text-center"},L={class:"fs-3"},M={class:"detail"},V={class:"text-secondary"},C={class:"text-primary"},T={class:"text-secondary"},B={class:"text-primary"},F={class:"text-secondary"},R=["disabled"],q=t("option",{disabled:""},"請選擇折抵時數",-1),P=["value"],j={key:0,class:"text-secondary"},E={key:1,class:"warningInfo"},U=t("p",{class:"text-success fs-6 mt-1"},[t("img",{src:x,alt:"info-icon"}),l(" 無需繳費，請儘速離場，謝謝！")],-1),Y=[U],z={class:"mt-2 d-flex justify-content-center"},G={key:2,class:"billDetail d-flex flex-column mt-5"},J={class:"text-success text-center fs-3"},K={class:"text-center"},O={class:"fs-3"},Q={key:3,class:"billDetail d-flex flex-column mt-5"},W={class:"text-danger text-center fs-3"},X=t("span",{class:"text-center fs-6 mb-2"},"請直接繳費離場",-1),Z={class:"text-center"},$={class:"fs-3"},tt=t("p",{class:"text-danger text-center fs-6 mb-2"},"如有疑問，請洽停車場管理員",-1);function st(h,e,r,p,s,c){return i(),o("main",null,[D,s.isLoading?(i(),o("div",v)):d("",!0),!s.hasApplied&&!s.isLoading?(i(),o("div",k,[t("div",H,n(s.billDetail.plate),1),t("div",A,[t("div",w,[t("div",S,[I,t("p",N,[l("NT$ "),t("span",L,n(s.billDetail.fee),1)])]),t("div",M,[t("p",V,[l("停車地點"),t("span",C,"　"+n(s.billDetail.station),1)]),t("p",T,[l("進場時間"),t("span",B,"　"+n(s.billDetail.arr_time),1)]),t("p",F,[l("折抵時數　 "),t("select",{class:"form-select-sm",id:"discountHours",disabled:s.billDetail.amount<=0,required:""},[q,(i(!0),o(b,null,f(s.hourArr,a=>(i(),o("option",{value:a},n(a)+" 小時",9,P))),256))],8,R)])]),s.billDetail.hasApplied&&s.billDetail.amount!=0?(i(),o("div",j," 今日無法再次折抵，請直接繳費離場！ ")):d("",!0),s.billDetail.amount==0?(i(),o("div",E,Y)):d("",!0),t("div",z,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...a)=>c.getHours&&c.getHours(...a))},"確認折抵")])])])])):s.hasApplied&&s.getSucces?(i(),o("div",G,[t("p",J,n(s.getMessage),1),t("p",K,[l("應繳金額 NT$ "),t("span",O,n(s.billDetail.fee),1)]),t("button",{class:"btn btn-primary w-50 align-self-center mb-3",onClick:e[1]||(e[1]=(...a)=>c.pay&&c.pay(...a))},"繳費離場")])):s.hasApplied&&!s.getSucces?(i(),o("div",Q,[t("p",W,n(s.getMessage),1),X,t("p",Z,[l("應繳金額 NT$ "),t("span",$,n(s.billDetail.fee),1)]),t("button",{class:"btn btn-primary w-50 align-self-center mb-3",onClick:e[2]||(e[2]=(...a)=>c.pay&&c.pay(...a))},"繳費離場"),tt])):d("",!0)])}const it=u(y,[["render",st]]);export{it as default};
